{"ast":null,"code":"import React,{useRef,useEffect,useState,useCallback}from'react';import'./TableComponent.css';import dictConfig from'../config/dictConfig.js';import{getTasks,createTask,createStep,updateStep,deleteStep,deleteTask,updateTask// 新增\n}from'../services/taskService.js';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const TableComponent=_ref=>{let{taskCircleId,loading}=_ref;const tableRef=useRef(null);const[showAddTaskRow,setShowAddTaskRow]=useState(false);const[showAddStepRow,setShowAddStepRow]=useState(null);const[newTaskName,setNewTaskName]=useState('');// 1. 修改初始状态定义\nconst[newStepData,setNewStepData]=useState({task_step:'',startdate:'',enddate:'',responsibility:'',taskstate:'',iscomplete:'否',// 默认设为“否”\nislate:'否',// 默认设为“否”\npriority:'',remark:''});const[editingCell,setEditingCell]=useState(null);const[editValue,setEditValue]=useState('');const[tableData,setTableData]=useState([]);const[isCollapsed,setIsCollapsed]=useState(false);// 新增：折叠状态\n// 列宽调整功能保持不变\nuseEffect(()=>{if(!tableRef.current)return;const table=tableRef.current;const cols=table.querySelectorAll('th');let isResizing=false;let currentCol=null;let startX=0;let startWidth=0;const handleMouseDown=e=>{if(e.target.classList.contains('resizer')){isResizing=true;currentCol=e.target.parentElement;startX=e.pageX;startWidth=currentCol.offsetWidth;document.body.style.cursor='col-resize';}};const handleMouseMove=e=>{if(!isResizing)return;const width=startWidth+(e.pageX-startX);if(width>50){currentCol.style.width=`${width}px`;}};const handleMouseUp=()=>{isResizing=false;document.body.style.cursor='';};table.addEventListener('mousedown',handleMouseDown);document.addEventListener('mousemove',handleMouseMove);document.addEventListener('mouseup',handleMouseUp);return()=>{table.removeEventListener('mousedown',handleMouseDown);document.removeEventListener('mousemove',handleMouseMove);document.removeEventListener('mouseup',handleMouseUp);};},[]);// 修改handleAddStep函数\n// 修改handleAddStep函数中的初始值\nconst handleAddStep=taskId=>{setShowAddStepRow(taskId);setNewStepData({task_step:'',startdate:'',enddate:'',responsibility:'',taskstate:'',iscomplete:'否',// 默认设为“否”\nislate:'否',// 默认设为“否”\npriority:'',remark:''});};// 处理双击单元格事件\nconst handleCellDoubleClick=(taskId,stepId,field,value)=>{setEditingCell({taskId,stepId,field});setEditValue(value);};// 处理保存编辑\nconst handleSaveEdit=async()=>{if(!editingCell)return;const{taskId,stepId,field}=editingCell;// 添加日期验证\nif(stepId&&(field==='startdate'||field==='enddate')){// 找到对应的步骤\nlet step=null;let task=null;for(const t of tableData){if(t.id===taskId){task=t;for(const s of t.steps){if(s.id===stepId){step=s;break;}}break;}}if(step){let startDate,endDate;if(field==='startdate'){startDate=new Date(editValue);endDate=new Date(step.enddate);// 只有当截止日期不为空时，才进行验证\nif(step.enddate&&endDate<startDate){alert('截止日期不能早于开始日期');return;}}else{startDate=new Date(step.startdate);endDate=new Date(editValue);if(endDate<startDate){alert('截止日期不能早于开始日期');return;}}}}// 更新本地数据\nconst updatedData=tableData.map(task=>{if(task.id===taskId){// 如果是任务名称字段\nif(field==='task_name'){// 准备更新数据\nconst updatedTask={...task,task_name:editValue};// 调用更新函数\nupdateTask(taskId,{task_name:editValue}).then(response=>{console.log('更新任务成功:',response);}).catch(error=>{console.error('更新任务失败:',error);});return updatedTask;}// 如果是步骤字段\nelse if(stepId){return{...task,steps:task.steps.map(step=>{if(step.id===stepId){// 准备更新数据\nconst updatedStep={...step,[field]:editValue};// 调用更新函数\nupdateStep(stepId,updatedStep).then(response=>{console.log('更新步骤成功:',response);}).catch(error=>{console.error('更新步骤失败:',error);});return updatedStep;}return step;})};}}return task;});setTableData(updatedData);setEditingCell(null);};// 处理取消编辑\nconst handleCancelEdit=()=>{setEditingCell(null);};// 使用 useCallback 包装获取数据的函数\nconst fetchData=useCallback(async()=>{if(taskCircleId){const data=await getTasks(taskCircleId);setTableData(data);}else{setTableData([]);}},[taskCircleId]);// 监听 taskCircleId 变化，重新获取数据\nuseEffect(()=>{fetchData();},[fetchData]);// 异步处理添加任务\nconst handleAddTask=async()=>{if(newTaskName.trim()&&taskCircleId){try{// 创建新任务\nconst newTask=await createTask(newTaskName,taskCircleId);// 更新表格数据\nsetTableData([...tableData,newTask]);// 重置表单\nsetNewTaskName('');setShowAddTaskRow(false);}catch(error){console.error('添加任务失败:',error);alert('添加任务失败，请稍后再试。');}}};// 异步处理保存步骤\nconst handleSaveStep=async taskId=>{if(newStepData.task_step.trim()&&taskId&&taskCircleId){// 添加日期验证\nif(newStepData.startdate&&newStepData.enddate){const startDate=new Date(newStepData.startdate);const endDate=new Date(newStepData.enddate);if(endDate<startDate){alert('截止日期不能早于开始日期');return;}}try{// 创建新步骤\nconst newStep=await createStep(newStepData,taskId,taskCircleId);// 更新表格数据\nconst updatedData=tableData.map(task=>{if(task.id===taskId){// 添加新步骤\nreturn{...task,steps:Array.isArray(task.steps)?[...task.steps,newStep]:[newStep]};}return task;});setTableData(updatedData);setShowAddStepRow(null);}catch(error){console.error('添加步骤失败:',error);alert('添加步骤失败，请稍后再试。');}}};// 新增：处理删除步骤\nconst handleDeleteStep=async(taskId,stepId)=>{if(window.confirm('确定要删除这个步骤吗？')){try{// 调用删除步骤的API\nawait deleteStep(stepId);// 更新本地数据\nconst updatedData=tableData.map(task=>{if(task.id===taskId){return{...task,steps:task.steps.filter(step=>step.id!==stepId)};}return task;});setTableData(updatedData);}catch(error){console.error('删除步骤失败:',error);alert('删除步骤失败，请稍后再试。');}}};// 删除任务及其所有步骤\nconst handleDeleteTask=async taskId=>{try{// 这里我们假设会有一个 deleteTask 函数来删除任务\n// 你需要在 taskService.js 中添加这个函数\nawait deleteTask(taskId);// 更新本地数据\nsetTableData(prevData=>prevData.filter(task=>task.id!==taskId));// 显示成功消息\nalert('任务及其所有步骤已成功删除');}catch(error){console.error('删除任务失败:',error);alert('删除任务失败，请重试');}};return/*#__PURE__*/_jsxs(\"div\",{className:\"table-container\",children:[loading&&/*#__PURE__*/_jsx(\"div\",{className:\"loading-overlay\",children:\"\\u52A0\\u8F7D\\u4E2D...\"}),/*#__PURE__*/_jsxs(\"table\",{ref:tableRef,className:\"resizable-table\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsxs(\"th\",{style:{position:'relative',paddingLeft:'30px'},children:[/*#__PURE__*/_jsx(\"button\",{className:\"collapse-btn\",style:{position:'absolute',left:'5px',top:'50%',transform:'translateY(-50%)',width:'20px',height:'20px',backgroundColor:'#1890ff',color:'white',border:'none',borderRadius:'4px',cursor:'pointer',display:'flex',alignItems:'center',justifyContent:'center',fontSize:'12px'},onClick:()=>setIsCollapsed(!isCollapsed),children:isCollapsed?'+':'-'}),\"\\u4EFB\\u52A1\\u540D\\u79F0 \",/*#__PURE__*/_jsx(\"div\",{className:\"resizer\"})]}),/*#__PURE__*/_jsxs(\"th\",{children:[\"\\u4EFB\\u52A1\\u6B65\\u9AA4 \",/*#__PURE__*/_jsx(\"div\",{className:\"resizer\"})]}),/*#__PURE__*/_jsxs(\"th\",{children:[\"\\u5F00\\u59CB\\u65E5\\u671F \",/*#__PURE__*/_jsx(\"div\",{className:\"resizer\"})]}),/*#__PURE__*/_jsxs(\"th\",{children:[\"\\u622A\\u81F3\\u65E5\\u671F \",/*#__PURE__*/_jsx(\"div\",{className:\"resizer\"})]}),/*#__PURE__*/_jsxs(\"th\",{children:[\"\\u8D23\\u4EFB\\u4EBA \",/*#__PURE__*/_jsx(\"div\",{className:\"resizer\"})]}),/*#__PURE__*/_jsxs(\"th\",{children:[\"\\u5F53\\u524D\\u72B6\\u6001 \",/*#__PURE__*/_jsx(\"div\",{className:\"resizer\"})]}),/*#__PURE__*/_jsxs(\"th\",{children:[\"\\u662F\\u5426\\u5B8C\\u6210 \",/*#__PURE__*/_jsx(\"div\",{className:\"resizer\"})]}),/*#__PURE__*/_jsxs(\"th\",{children:[\"\\u662F\\u5426\\u8D85\\u671F \",/*#__PURE__*/_jsx(\"div\",{className:\"resizer\"})]}),/*#__PURE__*/_jsxs(\"th\",{children:[\"\\u4F18\\u5148\\u7EA7 \",/*#__PURE__*/_jsx(\"div\",{className:\"resizer\"})]}),/*#__PURE__*/_jsxs(\"th\",{children:[\"\\u5907\\u6CE8 \",/*#__PURE__*/_jsx(\"div\",{className:\"resizer\"})]})]})}),/*#__PURE__*/_jsxs(\"tbody\",{children:[showAddTaskRow&&/*#__PURE__*/_jsxs(\"tr\",{className:\"new-task-row\",children:[/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsxs(\"div\",{className:\"new-task-input-container\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:newTaskName,onChange:e=>setNewTaskName(e.target.value),placeholder:\"\\u8F93\\u5165\\u4EFB\\u52A1\\u540D\\u79F0\",autoFocus:true}),/*#__PURE__*/_jsxs(\"div\",{className:\"new-task-buttons\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"save-task-btn\",onClick:handleAddTask,children:\"\\u4FDD\\u5B58\"}),/*#__PURE__*/_jsx(\"button\",{className:\"cancel-task-btn\",onClick:()=>setShowAddTaskRow(false),children:\"\\u53D6\\u6D88\"})]})]})}),[...Array(9)].map((_,i)=>/*#__PURE__*/_jsx(\"td\",{},`empty-${i}`))]}),tableData.map(task=>/*#__PURE__*/_jsxs(React.Fragment,{children:[/*#__PURE__*/_jsxs(\"tr\",{className:\"task-row\",children:[/*#__PURE__*/_jsxs(\"td\",{onDoubleClick:()=>handleCellDoubleClick(task.id,null,'task_name',task.task_name),style:{position:'relative',paddingLeft:'30px'}// 增加左侧内边距容纳按钮\n,children:[/*#__PURE__*/_jsx(\"button\",{className:\"delete-task-btn\",style:{position:'absolute',left:'5px',top:'50%',transform:'translateY(-50%)',width:'20px',height:'20px',backgroundColor:'#ff4d4f',color:'white',border:'none',borderRadius:'4px',cursor:'pointer',display:'flex',alignItems:'center',justifyContent:'center',fontSize:'12px'},onClick:e=>{e.stopPropagation();// 防止触发双击编辑\nif(window.confirm('确定要删除这个任务及其所有步骤吗？')){handleDeleteTask(task.id);}},children:\"\\xD7\"}),editingCell&&editingCell.taskId===task.id&&editingCell.field==='task_name'&&!editingCell.stepId?/*#__PURE__*/_jsxs(\"div\",{className:\"edit-cell-container\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:editValue,onChange:e=>setEditValue(e.target.value),autoFocus:true}),/*#__PURE__*/_jsxs(\"div\",{className:\"edit-buttons\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"save-edit-btn\",onClick:handleSaveEdit,children:\"\\u4FDD\\u5B58\"}),/*#__PURE__*/_jsx(\"button\",{className:\"cancel-edit-btn\",onClick:handleCancelEdit,children:\"\\u53D6\\u6D88\"})]})]}):task.task_name]}),/*#__PURE__*/_jsx(\"td\",{colSpan:\"9\"}),\" \"]}),!isCollapsed&&(task.steps||[]).map(step=>/*#__PURE__*/_jsxs(\"tr\",{className:\"step-row\",children:[/*#__PURE__*/_jsx(\"td\",{}),\" \",/*#__PURE__*/_jsxs(\"td\",{onDoubleClick:()=>handleCellDoubleClick(task.id,step.id,'task_step',step.task_step),style:{position:'relative',paddingLeft:'30px'}// 增加左侧内边距容纳按钮\n,children:[/*#__PURE__*/_jsx(\"button\",{className:\"delete-step-btn\",style:{position:'absolute',left:'5px',top:'50%',transform:'translateY(-50%)',width:'20px',height:'20px',backgroundColor:'#ff4d4f',color:'white',border:'none',borderRadius:'4px',cursor:'pointer',display:'flex',alignItems:'center',justifyContent:'center',fontSize:'12px'},onClick:e=>{e.stopPropagation();// 防止触发双击编辑\nhandleDeleteStep(task.id,step.id);},children:\"\\xD7\"}),editingCell&&editingCell.taskId===task.id&&editingCell.stepId===step.id&&editingCell.field==='task_step'?/*#__PURE__*/_jsxs(\"div\",{className:\"edit-cell-container\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:editValue,onChange:e=>setEditValue(e.target.value),autoFocus:true}),/*#__PURE__*/_jsxs(\"div\",{className:\"edit-buttons\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"save-edit-btn\",onClick:handleSaveEdit,children:\"\\u4FDD\\u5B58\"}),/*#__PURE__*/_jsx(\"button\",{className:\"cancel-edit-btn\",onClick:handleCancelEdit,children:\"\\u53D6\\u6D88\"})]})]}):step.task_step]}),/*#__PURE__*/_jsx(\"td\",{onDoubleClick:()=>handleCellDoubleClick(task.id,step.id,'startdate',step.startdate),children:editingCell&&editingCell.taskId===task.id&&editingCell.stepId===step.id&&editingCell.field==='startdate'?/*#__PURE__*/_jsxs(\"div\",{className:\"edit-cell-container\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"date\",value:editValue,onChange:e=>setEditValue(e.target.value),autoFocus:true}),/*#__PURE__*/_jsxs(\"div\",{className:\"edit-buttons\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"save-edit-btn\",onClick:handleSaveEdit,children:\"\\u4FDD\\u5B58\"}),/*#__PURE__*/_jsx(\"button\",{className:\"cancel-edit-btn\",onClick:handleCancelEdit,children:\"\\u53D6\\u6D88\"})]})]}):step.startdate?new Date(step.startdate).toLocaleDateString('zh-CN'):''}),/*#__PURE__*/_jsx(\"td\",{onDoubleClick:()=>handleCellDoubleClick(task.id,step.id,'enddate',step.enddate),children:editingCell&&editingCell.taskId===task.id&&editingCell.stepId===step.id&&editingCell.field==='enddate'?/*#__PURE__*/_jsxs(\"div\",{className:\"edit-cell-container\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"date\",value:editValue,onChange:e=>setEditValue(e.target.value),autoFocus:true}),/*#__PURE__*/_jsxs(\"div\",{className:\"edit-buttons\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"save-edit-btn\",onClick:handleSaveEdit,children:\"\\u4FDD\\u5B58\"}),/*#__PURE__*/_jsx(\"button\",{className:\"cancel-edit-btn\",onClick:handleCancelEdit,children:\"\\u53D6\\u6D88\"})]})]}):step.enddate?new Date(step.enddate).toLocaleDateString('zh-CN'):''}),/*#__PURE__*/_jsx(\"td\",{onDoubleClick:()=>handleCellDoubleClick(task.id,step.id,'responsibility',step.responsibility),children:editingCell&&editingCell.taskId===task.id&&editingCell.stepId===step.id&&editingCell.field==='responsibility'?/*#__PURE__*/_jsxs(\"div\",{className:\"edit-cell-container\",children:[/*#__PURE__*/_jsxs(\"select\",{value:editValue,onChange:e=>setEditValue(e.target.value),autoFocus:true,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"\\u9009\\u62E9\\u8D23\\u4EFB\\u4EBA\"}),dictConfig.responsiblePerson.map(person=>/*#__PURE__*/_jsx(\"option\",{value:person,children:person},person))]}),/*#__PURE__*/_jsxs(\"div\",{className:\"edit-buttons\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"save-edit-btn\",onClick:handleSaveEdit,children:\"\\u4FDD\\u5B58\"}),/*#__PURE__*/_jsx(\"button\",{className:\"cancel-edit-btn\",onClick:handleCancelEdit,children:\"\\u53D6\\u6D88\"})]})]}):step.responsibility}),/*#__PURE__*/_jsx(\"td\",{onDoubleClick:()=>handleCellDoubleClick(task.id,step.id,'taskstate',step.taskstate),children:editingCell&&editingCell.taskId===task.id&&editingCell.stepId===step.id&&editingCell.field==='taskstate'?/*#__PURE__*/_jsxs(\"div\",{className:\"edit-cell-container\",children:[/*#__PURE__*/_jsxs(\"select\",{value:editValue,onChange:e=>setEditValue(e.target.value),autoFocus:true,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"\\u9009\\u62E9\\u5F53\\u524D\\u72B6\\u6001\"}),dictConfig.status.map(status=>/*#__PURE__*/_jsx(\"option\",{value:status,children:status},status))]}),/*#__PURE__*/_jsxs(\"div\",{className:\"edit-buttons\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"save-edit-btn\",onClick:handleSaveEdit,children:\"\\u4FDD\\u5B58\"}),/*#__PURE__*/_jsx(\"button\",{className:\"cancel-edit-btn\",onClick:handleCancelEdit,children:\"\\u53D6\\u6D88\"})]})]}):step.taskstate}),/*#__PURE__*/_jsx(\"td\",{// 修改双击事件处理函数的参数\nonDoubleClick:()=>handleCellDoubleClick(task.id,step.id,'iscomplete',step.iscomplete),children:editingCell&&editingCell.taskId===task.id&&editingCell.stepId===step.id&&editingCell.field==='iscomplete'?/*#__PURE__*/_jsxs(\"div\",{className:\"edit-cell-container\",children:[/*#__PURE__*/_jsxs(\"select\",{value:editValue,onChange:e=>setEditValue(e.target.value),autoFocus:true,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\\u662F\",children:\"\\u662F\"}),/*#__PURE__*/_jsx(\"option\",{value:\"\\u5426\",children:\"\\u5426\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"edit-buttons\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"save-edit-btn\",onClick:handleSaveEdit,children:\"\\u4FDD\\u5B58\"}),/*#__PURE__*/_jsx(\"button\",{className:\"cancel-edit-btn\",onClick:handleCancelEdit,children:\"\\u53D6\\u6D88\"})]})]}):step.iscomplete// 直接显示枚举值，不再使用三元表达式\n}),/*#__PURE__*/_jsx(\"td\",{onDoubleClick:()=>handleCellDoubleClick(task.id,step.id,'islate',step.islate),children:editingCell&&editingCell.taskId===task.id&&editingCell.stepId===step.id&&editingCell.field==='islate'?/*#__PURE__*/_jsxs(\"div\",{className:\"edit-cell-container\",children:[/*#__PURE__*/_jsxs(\"select\",{value:editValue,onChange:e=>setEditValue(e.target.value),autoFocus:true,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\\u662F\",children:\"\\u662F\"}),/*#__PURE__*/_jsx(\"option\",{value:\"\\u5426\",children:\"\\u5426\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"edit-buttons\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"save-edit-btn\",onClick:handleSaveEdit,children:\"\\u4FDD\\u5B58\"}),/*#__PURE__*/_jsx(\"button\",{className:\"cancel-edit-btn\",onClick:handleCancelEdit,children:\"\\u53D6\\u6D88\"})]})]}):step.islate// 直接显示枚举值，不再使用三元表达式\n}),/*#__PURE__*/_jsx(\"td\",{onDoubleClick:()=>handleCellDoubleClick(task.id,step.id,'priority',step.priority),children:editingCell&&editingCell.taskId===task.id&&editingCell.stepId===step.id&&editingCell.field==='priority'?/*#__PURE__*/_jsxs(\"div\",{className:\"edit-cell-container\",children:[/*#__PURE__*/_jsxs(\"select\",{value:editValue,onChange:e=>setEditValue(e.target.value),autoFocus:true,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"\\u9009\\u62E9\\u4F18\\u5148\\u7EA7\"}),dictConfig.priority.map(priority=>/*#__PURE__*/_jsx(\"option\",{value:priority,children:priority},priority))]}),/*#__PURE__*/_jsxs(\"div\",{className:\"edit-buttons\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"save-edit-btn\",onClick:handleSaveEdit,children:\"\\u4FDD\\u5B58\"}),/*#__PURE__*/_jsx(\"button\",{className:\"cancel-edit-btn\",onClick:handleCancelEdit,children:\"\\u53D6\\u6D88\"})]})]}):step.priority}),/*#__PURE__*/_jsx(\"td\",{onDoubleClick:()=>handleCellDoubleClick(task.id,step.id,'remark',step.remark),children:editingCell&&editingCell.taskId===task.id&&editingCell.stepId===step.id&&editingCell.field==='remark'?/*#__PURE__*/_jsxs(\"div\",{className:\"edit-cell-container\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:editValue,onChange:e=>setEditValue(e.target.value),autoFocus:true}),/*#__PURE__*/_jsxs(\"div\",{className:\"edit-buttons\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"save-edit-btn\",onClick:handleSaveEdit,children:\"\\u4FDD\\u5B58\"}),/*#__PURE__*/_jsx(\"button\",{className:\"cancel-edit-btn\",onClick:handleCancelEdit,children:\"\\u53D6\\u6D88\"})]})]}):step.remark})]},step.id)),/*#__PURE__*/_jsxs(\"tr\",{className:\"add-step-row\",children:[/*#__PURE__*/_jsx(\"td\",{}),\" \",/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"button\",{className:\"add-step-btn\",onClick:()=>handleAddStep(task.id),children:\"+\"})}),[...Array(8)].map((_,i)=>/*#__PURE__*/_jsx(\"td\",{},`step-empty-${i}`))]}),showAddStepRow===task.id&&/*#__PURE__*/_jsxs(\"tr\",{className:\"new-step-row\",children:[/*#__PURE__*/_jsx(\"td\",{rowSpan:\"1\"}),/*#__PURE__*/_jsxs(\"td\",{children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:newStepData.task_step,onChange:e=>setNewStepData({...newStepData,task_step:e.target.value}),placeholder:\"\\u8F93\\u5165\\u4EFB\\u52A1\\u6B65\\u9AA4\",autoFocus:true}),/*#__PURE__*/_jsxs(\"div\",{className:\"new-step-buttons\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"save-step-btn\",onClick:()=>handleSaveStep(task.id),children:\"\\u4FDD\\u5B58\"}),/*#__PURE__*/_jsx(\"button\",{className:\"cancel-step-btn\",onClick:()=>setShowAddStepRow(null),children:\"\\u53D6\\u6D88\"})]})]}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"input\",{type:\"date\",value:newStepData.startdate,onChange:e=>setNewStepData({...newStepData,startdate:e.target.value})})}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"input\",{type:\"date\",value:newStepData.enddate,onChange:e=>setNewStepData({...newStepData,enddate:e.target.value})})}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsxs(\"select\",{value:newStepData.responsibility,onChange:e=>setNewStepData({...newStepData,responsibility:e.target.value}),children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"\\u9009\\u62E9\\u8D23\\u4EFB\\u4EBA\"}),dictConfig.responsiblePerson.map(person=>/*#__PURE__*/_jsx(\"option\",{value:person,children:person},person))]})}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsxs(\"select\",{value:newStepData.taskstate,onChange:e=>setNewStepData({...newStepData,taskstate:e.target.value}),children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"\\u9009\\u62E9\\u5F53\\u524D\\u72B6\\u6001\"}),dictConfig.status.map(status=>/*#__PURE__*/_jsx(\"option\",{value:status,children:status},status))]})}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsxs(\"select\",{value:newStepData.iscomplete,onChange:e=>setNewStepData({...newStepData,iscomplete:e.target.value}),children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"\\u9009\\u62E9\"}),/*#__PURE__*/_jsx(\"option\",{value:\"\\u662F\",children:\"\\u662F\"}),/*#__PURE__*/_jsx(\"option\",{value:\"\\u5426\",children:\"\\u5426\"})]})}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsxs(\"select\",{value:newStepData.islate,onChange:e=>setNewStepData({...newStepData,islate:e.target.value}),children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"\\u9009\\u62E9\"}),/*#__PURE__*/_jsx(\"option\",{value:\"\\u662F\",children:\"\\u662F\"}),/*#__PURE__*/_jsx(\"option\",{value:\"\\u5426\",children:\"\\u5426\"})]})}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsxs(\"select\",{value:newStepData.priority,onChange:e=>setNewStepData({...newStepData,priority:e.target.value}),children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"\\u9009\\u62E9\\u4F18\\u5148\\u7EA7\"}),dictConfig.priority.map(priority=>/*#__PURE__*/_jsx(\"option\",{value:priority,children:priority},priority))]})}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:newStepData.remark,onChange:e=>setNewStepData({...newStepData,remark:e.target.value}),placeholder:\"\\u5907\\u6CE8\"})})]})]},task.id)),/*#__PURE__*/_jsxs(\"tr\",{className:\"add-task-row\",children:[/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"button\",{className:\"add-task-btn\",onClick:()=>setShowAddTaskRow(true),children:\"+\"})}),[...Array(9)].map((_,i)=>/*#__PURE__*/_jsx(\"td\",{},`add-empty-${i}`))]})]})]})]});};export default TableComponent;const handleAddStep=async newStep=>{// 从状态/上下文/Props中获取当前阶段ID\nconst{currentPhaseId}=this.state;// 或其他获取方式\nawait createStep(newStep,currentPhaseId);};","map":{"version":3,"names":["React","useRef","useEffect","useState","useCallback","dictConfig","getTasks","createTask","createStep","updateStep","deleteStep","deleteTask","updateTask","jsx","_jsx","jsxs","_jsxs","TableComponent","_ref","taskCircleId","loading","tableRef","showAddTaskRow","setShowAddTaskRow","showAddStepRow","setShowAddStepRow","newTaskName","setNewTaskName","newStepData","setNewStepData","task_step","startdate","enddate","responsibility","taskstate","iscomplete","islate","priority","remark","editingCell","setEditingCell","editValue","setEditValue","tableData","setTableData","isCollapsed","setIsCollapsed","current","table","cols","querySelectorAll","isResizing","currentCol","startX","startWidth","handleMouseDown","e","target","classList","contains","parentElement","pageX","offsetWidth","document","body","style","cursor","handleMouseMove","width","handleMouseUp","addEventListener","removeEventListener","handleAddStep","taskId","handleCellDoubleClick","stepId","field","value","handleSaveEdit","step","task","t","id","s","steps","startDate","endDate","Date","alert","updatedData","map","updatedTask","task_name","then","response","console","log","catch","error","updatedStep","handleCancelEdit","fetchData","data","handleAddTask","trim","newTask","handleSaveStep","newStep","Array","isArray","handleDeleteStep","window","confirm","filter","handleDeleteTask","prevData","className","children","ref","position","paddingLeft","left","top","transform","height","backgroundColor","color","border","borderRadius","display","alignItems","justifyContent","fontSize","onClick","type","onChange","placeholder","autoFocus","_","i","Fragment","onDoubleClick","stopPropagation","colSpan","toLocaleDateString","responsiblePerson","person","status","rowSpan","currentPhaseId","state"],"sources":["E:/TraeProjects/DevelopmentDashboard/frontend/src/components/TableComponent.js"],"sourcesContent":["import React, { useRef, useEffect, useState, useCallback } from 'react';\r\nimport './TableComponent.css';\r\n\r\nimport dictConfig from '../config/dictConfig.js';\r\nimport {\r\n  getTasks,\r\n  createTask,\r\n  createStep,\r\n  updateStep,\r\n  deleteStep,\r\n  deleteTask,\r\n  updateTask // 新增\r\n} from '../services/taskService.js';\r\n\r\nconst TableComponent = ({ taskCircleId, loading }) => {\r\n  const tableRef = useRef(null);\r\n  const [showAddTaskRow, setShowAddTaskRow] = useState(false);\r\n  const [showAddStepRow, setShowAddStepRow] = useState(null);\r\n  const [newTaskName, setNewTaskName] = useState('');\r\n  // 1. 修改初始状态定义\r\n  const [newStepData, setNewStepData] = useState({\r\n    task_step: '',\r\n    startdate: '',\r\n    enddate: '',\r\n    responsibility: '',\r\n    taskstate: '',\r\n    iscomplete: '否', // 默认设为“否”\r\n    islate: '否',     // 默认设为“否”\r\n    priority: '',\r\n    remark: ''\r\n  });\r\n  const [editingCell, setEditingCell] = useState(null);\r\n  const [editValue, setEditValue] = useState('');\r\n  const [tableData, setTableData] = useState([]);\r\n  const [isCollapsed, setIsCollapsed] = useState(false); // 新增：折叠状态\r\n\r\n  // 列宽调整功能保持不变\r\n  useEffect(() => {\r\n    if (!tableRef.current) return;\r\n\r\n    const table = tableRef.current;\r\n    const cols = table.querySelectorAll('th');\r\n    let isResizing = false;\r\n    let currentCol = null;\r\n    let startX = 0;\r\n    let startWidth = 0;\r\n\r\n    const handleMouseDown = (e) => {\r\n      if (e.target.classList.contains('resizer')) {\r\n        isResizing = true;\r\n        currentCol = e.target.parentElement;\r\n        startX = e.pageX;\r\n        startWidth = currentCol.offsetWidth;\r\n        document.body.style.cursor = 'col-resize';\r\n      }\r\n    };\r\n\r\n    const handleMouseMove = (e) => {\r\n      if (!isResizing) return;\r\n      const width = startWidth + (e.pageX - startX);\r\n      if (width > 50) {\r\n        currentCol.style.width = `${width}px`;\r\n      }\r\n    };\r\n\r\n    const handleMouseUp = () => {\r\n      isResizing = false;\r\n      document.body.style.cursor = '';\r\n    };\r\n\r\n    table.addEventListener('mousedown', handleMouseDown);\r\n    document.addEventListener('mousemove', handleMouseMove);\r\n    document.addEventListener('mouseup', handleMouseUp);\r\n\r\n    return () => {\r\n      table.removeEventListener('mousedown', handleMouseDown);\r\n      document.removeEventListener('mousemove', handleMouseMove);\r\n      document.removeEventListener('mouseup', handleMouseUp);\r\n    };\r\n  }, []);\r\n\r\n  // 修改handleAddStep函数\r\n  // 修改handleAddStep函数中的初始值\r\n  const handleAddStep = (taskId) => {\r\n    setShowAddStepRow(taskId);\r\n    setNewStepData({\r\n      task_step: '',\r\n      startdate: '',\r\n      enddate: '',\r\n      responsibility: '',\r\n      taskstate: '',\r\n      iscomplete: '否', // 默认设为“否”\r\n      islate: '否',     // 默认设为“否”\r\n      priority: '',\r\n      remark: ''\r\n    });\r\n  };\r\n\r\n  // 处理双击单元格事件\r\n  const handleCellDoubleClick = (taskId, stepId, field, value) => {\r\n    setEditingCell({ taskId, stepId, field });\r\n    setEditValue(value);\r\n  };\r\n\r\n  // 处理保存编辑\r\n  const handleSaveEdit = async () => {\r\n    if (!editingCell) return;\r\n\r\n    const { taskId, stepId, field } = editingCell;\r\n\r\n    // 添加日期验证\r\n    if (stepId && (field === 'startdate' || field === 'enddate')) {\r\n      // 找到对应的步骤\r\n      let step = null;\r\n      let task = null;\r\n      for (const t of tableData) {\r\n        if (t.id === taskId) {\r\n          task = t;\r\n          for (const s of t.steps) {\r\n            if (s.id === stepId) {\r\n              step = s;\r\n              break;\r\n            }\r\n          }\r\n          break;\r\n        }\r\n      }\r\n\r\n      if (step) {\r\n        let startDate, endDate;\r\n        if (field === 'startdate') {\r\n          startDate = new Date(editValue);\r\n          endDate = new Date(step.enddate);\r\n          // 只有当截止日期不为空时，才进行验证\r\n          if (step.enddate && endDate < startDate) {\r\n            alert('截止日期不能早于开始日期');\r\n            return;\r\n          }\r\n        } else {\r\n          startDate = new Date(step.startdate);\r\n          endDate = new Date(editValue);\r\n          if (endDate < startDate) {\r\n            alert('截止日期不能早于开始日期');\r\n            return;\r\n          }\r\n        }\r\n      }\r\n    }\r\n\r\n    // 更新本地数据\r\n    const updatedData = tableData.map(task => {\r\n      if (task.id === taskId) {\r\n        // 如果是任务名称字段\r\n        if (field === 'task_name') {\r\n          // 准备更新数据\r\n          const updatedTask = {\r\n            ...task,\r\n            task_name: editValue\r\n          };\r\n          // 调用更新函数\r\n          updateTask(taskId, { task_name: editValue })\r\n            .then(response => {\r\n              console.log('更新任务成功:', response);\r\n            })\r\n            .catch(error => {\r\n              console.error('更新任务失败:', error);\r\n            });\r\n          return updatedTask;\r\n        }\r\n        // 如果是步骤字段\r\n        else if (stepId) {\r\n          return {\r\n            ...task,\r\n            steps: task.steps.map(step => {\r\n              if (step.id === stepId) {\r\n                // 准备更新数据\r\n                const updatedStep = {\r\n                  ...step,\r\n                  [field]: editValue\r\n                };\r\n                // 调用更新函数\r\n                updateStep(stepId, updatedStep)\r\n                  .then(response => {\r\n                    console.log('更新步骤成功:', response);\r\n                  })\r\n                  .catch(error => {\r\n                    console.error('更新步骤失败:', error);\r\n                  });\r\n                return updatedStep;\r\n              }\r\n              return step;\r\n            })\r\n          };\r\n        }\r\n      }\r\n      return task;\r\n    });\r\n\r\n    setTableData(updatedData);\r\n    setEditingCell(null);\r\n  };\r\n\r\n  // 处理取消编辑\r\n  const handleCancelEdit = () => {\r\n    setEditingCell(null);\r\n  };\r\n\r\n  // 使用 useCallback 包装获取数据的函数\r\n  const fetchData = useCallback(async () => {\r\n    if (taskCircleId) {\r\n      const data = await getTasks(taskCircleId);\r\n      setTableData(data);\r\n    } else {\r\n      setTableData([]);\r\n    }\r\n  }, [taskCircleId]);\r\n\r\n  // 监听 taskCircleId 变化，重新获取数据\r\n  useEffect(() => {\r\n    fetchData();\r\n  }, [fetchData]);\r\n\r\n  // 异步处理添加任务\r\n  const handleAddTask = async () => {\r\n    if (newTaskName.trim() && taskCircleId) {\r\n      try {\r\n        // 创建新任务\r\n        const newTask = await createTask(newTaskName, taskCircleId);\r\n        // 更新表格数据\r\n        setTableData([\r\n          ...tableData,\r\n          newTask\r\n        ]);\r\n        // 重置表单\r\n        setNewTaskName('');\r\n        setShowAddTaskRow(false);\r\n      } catch (error) {\r\n        console.error('添加任务失败:', error);\r\n        alert('添加任务失败，请稍后再试。');\r\n      }\r\n    }\r\n  };\r\n\r\n  // 异步处理保存步骤\r\n  const handleSaveStep = async (taskId) => {\r\n    if (newStepData.task_step.trim() && taskId && taskCircleId) {\r\n      // 添加日期验证\r\n      if (newStepData.startdate && newStepData.enddate) {\r\n        const startDate = new Date(newStepData.startdate);\r\n        const endDate = new Date(newStepData.enddate);\r\n        if (endDate < startDate) {\r\n          alert('截止日期不能早于开始日期');\r\n          return;\r\n        }\r\n      }\r\n\r\n      try {\r\n        // 创建新步骤\r\n        const newStep = await createStep(newStepData, taskId, taskCircleId);\r\n        // 更新表格数据\r\n        const updatedData = tableData.map(task => {\r\n          if (task.id === taskId) {\r\n            // 添加新步骤\r\n            return {\r\n              ...task,\r\n              steps: Array.isArray(task.steps) ? [...task.steps, newStep] : [newStep]\r\n            };\r\n          }\r\n          return task;\r\n        });\r\n        setTableData(updatedData);\r\n        setShowAddStepRow(null);\r\n      } catch (error) {\r\n        console.error('添加步骤失败:', error);\r\n        alert('添加步骤失败，请稍后再试。');\r\n      }\r\n    }\r\n  };\r\n\r\n  // 新增：处理删除步骤\r\n  const handleDeleteStep = async (taskId, stepId) => {\r\n    if (window.confirm('确定要删除这个步骤吗？')) {\r\n      try {\r\n        // 调用删除步骤的API\r\n        await deleteStep(stepId);\r\n        // 更新本地数据\r\n        const updatedData = tableData.map(task => {\r\n          if (task.id === taskId) {\r\n            return {\r\n              ...task,\r\n              steps: task.steps.filter(step => step.id !== stepId)\r\n            };\r\n          }\r\n          return task;\r\n        });\r\n        setTableData(updatedData);\r\n      } catch (error) {\r\n        console.error('删除步骤失败:', error);\r\n        alert('删除步骤失败，请稍后再试。');\r\n      }\r\n    }\r\n  };\r\n\r\n  // 删除任务及其所有步骤\r\n  const handleDeleteTask = async (taskId) => {\r\n    try {\r\n      // 这里我们假设会有一个 deleteTask 函数来删除任务\r\n      // 你需要在 taskService.js 中添加这个函数\r\n      await deleteTask(taskId);\r\n      // 更新本地数据\r\n      setTableData(prevData => prevData.filter(task => task.id !== taskId));\r\n      // 显示成功消息\r\n      alert('任务及其所有步骤已成功删除');\r\n    } catch (error) {\r\n      console.error('删除任务失败:', error);\r\n      alert('删除任务失败，请重试');\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"table-container\">\r\n      {loading && <div className=\"loading-overlay\">加载中...</div>}\r\n      <table ref={tableRef} className=\"resizable-table\">\r\n        <thead>\r\n          <tr>\r\n            <th style={{ position: 'relative', paddingLeft: '30px' }}>\r\n              <button \r\n                className=\"collapse-btn\"\r\n                style={{\r\n                  position: 'absolute',\r\n                  left: '5px',\r\n                  top: '50%',\r\n                  transform: 'translateY(-50%)',\r\n                  width: '20px',\r\n                  height: '20px',\r\n                  backgroundColor: '#1890ff',\r\n                  color: 'white',\r\n                  border: 'none',\r\n                  borderRadius: '4px',\r\n                  cursor: 'pointer',\r\n                  display: 'flex',\r\n                  alignItems: 'center',\r\n                  justifyContent: 'center',\r\n                  fontSize: '12px'\r\n                }}\r\n                onClick={() => setIsCollapsed(!isCollapsed)}\r\n              >\r\n                {isCollapsed ? '+' : '-'}\r\n              </button>\r\n              任务名称 <div className=\"resizer\"></div>\r\n            </th>\r\n            <th>任务步骤 <div className=\"resizer\"></div></th>\r\n            <th>开始日期 <div className=\"resizer\"></div></th>\r\n            <th>截至日期 <div className=\"resizer\"></div></th>\r\n            <th>责任人 <div className=\"resizer\"></div></th>\r\n            <th>当前状态 <div className=\"resizer\"></div></th>\r\n            <th>是否完成 <div className=\"resizer\"></div></th>\r\n            <th>是否超期 <div className=\"resizer\"></div></th>\r\n            <th>优先级 <div className=\"resizer\"></div></th>\r\n            <th>备注 <div className=\"resizer\"></div></th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          {/* 新任务的可编辑行 */}\r\n          {showAddTaskRow && (\r\n            <tr className=\"new-task-row\">\r\n              <td>\r\n                <div className=\"new-task-input-container\">\r\n                  <input\r\n                    type=\"text\"\r\n                    value={newTaskName}\r\n                    onChange={(e) => setNewTaskName(e.target.value)}\r\n                    placeholder=\"输入任务名称\"\r\n                    autoFocus\r\n                  />\r\n                  <div className=\"new-task-buttons\">\r\n                    <button className=\"save-task-btn\" onClick={handleAddTask}>保存</button>\r\n                    <button className=\"cancel-task-btn\" onClick={() => setShowAddTaskRow(false)}>取消</button>\r\n                  </div>\r\n                </div>\r\n              </td>\r\n              {/* 其他列的空单元格 */}\r\n              {[...Array(9)].map((_, i) => (\r\n                <td key={`empty-${i}`}></td>\r\n              ))}\r\n            </tr>\r\n          )}\r\n\r\n          {/* 现有任务和步骤 */}\r\n          {tableData.map(task => (\r\n            <React.Fragment key={task.id}>\r\n              {/* 任务行 */}\r\n              <tr className=\"task-row\">\r\n                <td\r\n                  onDoubleClick={() => handleCellDoubleClick(task.id, null, 'task_name', task.task_name)}\r\n                  style={{ position: 'relative', paddingLeft: '30px' }} // 增加左侧内边距容纳按钮\r\n                >\r\n                  {/* 新增：任务删除按钮 - 放在任务名称单元格的左侧，靠近左边框 */}\r\n                  <button \r\n                    className=\"delete-task-btn\"\r\n                    style={{\r\n                      position: 'absolute',\r\n                      left: '5px',\r\n                      top: '50%',\r\n                      transform: 'translateY(-50%)',\r\n                      width: '20px',\r\n                      height: '20px',\r\n                      backgroundColor: '#ff4d4f',\r\n                      color: 'white',\r\n                      border: 'none',\r\n                      borderRadius: '4px',\r\n                      cursor: 'pointer',\r\n                      display: 'flex',\r\n                      alignItems: 'center',\r\n                      justifyContent: 'center',\r\n                      fontSize: '12px'\r\n                    }}\r\n                    onClick={(e) => {\r\n                      e.stopPropagation(); // 防止触发双击编辑\r\n                      if (window.confirm('确定要删除这个任务及其所有步骤吗？')) {\r\n                        handleDeleteTask(task.id);\r\n                      }\r\n                    }}\r\n                  >\r\n                    ×\r\n                  </button>\r\n                  {editingCell && editingCell.taskId === task.id && editingCell.field === 'task_name' && !editingCell.stepId ? (\r\n                    <div className=\"edit-cell-container\">\r\n                      <input\r\n                        type=\"text\"\r\n                        value={editValue}\r\n                        onChange={(e) => setEditValue(e.target.value)}\r\n                        autoFocus\r\n                      />\r\n                      <div className=\"edit-buttons\">\r\n                        <button className=\"save-edit-btn\" onClick={handleSaveEdit}>保存</button>\r\n                        <button className=\"cancel-edit-btn\" onClick={handleCancelEdit}>取消</button>\r\n                      </div>\r\n                    </div>\r\n                  ) : (\r\n                    task.task_name\r\n                  )}\r\n                </td>\r\n                <td colSpan=\"9\"></td> {/* 合并其他列 */}\r\n              </tr>\r\n\r\n              {/* 任务的步骤 - 根据折叠状态决定是否显示 */}\r\n              {!isCollapsed && (task.steps || []).map(step => (\r\n                <tr key={step.id} className=\"step-row\">\r\n                  <td></td> {/* 任务名称列为空 */}\r\n                  <td\r\n                    onDoubleClick={() => handleCellDoubleClick(task.id, step.id, 'task_step', step.task_step)}\r\n                    style={{ position: 'relative', paddingLeft: '30px' }} // 增加左侧内边距容纳按钮\r\n                  >\r\n                    {/* 调整：删除按钮 - 放在步骤单元格的左侧，靠近左边框 */}\r\n                    <button \r\n                      className=\"delete-step-btn\"\r\n                      style={{\r\n                        position: 'absolute',\r\n                        left: '5px',\r\n                        top: '50%',\r\n                        transform: 'translateY(-50%)',\r\n                        width: '20px',\r\n                        height: '20px',\r\n                        backgroundColor: '#ff4d4f',\r\n                        color: 'white',\r\n                        border: 'none',\r\n                        borderRadius: '4px',\r\n                        cursor: 'pointer',\r\n                        display: 'flex',\r\n                        alignItems: 'center',\r\n                        justifyContent: 'center',\r\n                        fontSize: '12px'\r\n                      }}\r\n                      onClick={(e) => {\r\n                        e.stopPropagation(); // 防止触发双击编辑\r\n                        handleDeleteStep(task.id, step.id);\r\n                      }}\r\n                    >\r\n                      ×\r\n                    </button>\r\n                    {editingCell && editingCell.taskId === task.id && editingCell.stepId === step.id && editingCell.field === 'task_step' ? (\r\n                      <div className=\"edit-cell-container\">\r\n                        <input\r\n                          type=\"text\"\r\n                          value={editValue}\r\n                          onChange={(e) => setEditValue(e.target.value)}\r\n                          autoFocus\r\n                        />\r\n                        <div className=\"edit-buttons\">\r\n                          <button className=\"save-edit-btn\" onClick={handleSaveEdit}>保存</button>\r\n                          <button className=\"cancel-edit-btn\" onClick={handleCancelEdit}>取消</button>\r\n                        </div>\r\n                      </div>\r\n                    ) : (\r\n                      step.task_step\r\n                    )}\r\n                  </td>\r\n                  <td\r\n                    onDoubleClick={() => handleCellDoubleClick(task.id, step.id, 'startdate', step.startdate)}\r\n                  >\r\n                    {editingCell && editingCell.taskId === task.id && editingCell.stepId === step.id && editingCell.field === 'startdate' ? (\r\n                      <div className=\"edit-cell-container\">\r\n                        <input\r\n                          type=\"date\"\r\n                          value={editValue}\r\n                          onChange={(e) => setEditValue(e.target.value)}\r\n                          autoFocus\r\n                        />\r\n                        <div className=\"edit-buttons\">\r\n                          <button className=\"save-edit-btn\" onClick={handleSaveEdit}>保存</button>\r\n                          <button className=\"cancel-edit-btn\" onClick={handleCancelEdit}>取消</button>\r\n                        </div>\r\n                      </div>\r\n                    ) : (\r\n                      step.startdate ? new Date(step.startdate).toLocaleDateString('zh-CN') : ''\r\n                    )}\r\n                  </td>\r\n                  <td\r\n                    onDoubleClick={() => handleCellDoubleClick(task.id, step.id, 'enddate', step.enddate)}\r\n                  >\r\n                    {editingCell && editingCell.taskId === task.id && editingCell.stepId === step.id && editingCell.field === 'enddate' ? (\r\n                      <div className=\"edit-cell-container\">\r\n                        <input\r\n                          type=\"date\"\r\n                          value={editValue}\r\n                          onChange={(e) => setEditValue(e.target.value)}\r\n                          autoFocus\r\n                        />\r\n                        <div className=\"edit-buttons\">\r\n                          <button className=\"save-edit-btn\" onClick={handleSaveEdit}>保存</button>\r\n                          <button className=\"cancel-edit-btn\" onClick={handleCancelEdit}>取消</button>\r\n                        </div>\r\n                      </div>\r\n                    ) : (\r\n                      step.enddate ? new Date(step.enddate).toLocaleDateString('zh-CN') : ''\r\n                    )}\r\n                  </td>\r\n                  <td\r\n                    onDoubleClick={() => handleCellDoubleClick(task.id, step.id, 'responsibility', step.responsibility)}\r\n                  >\r\n                    {editingCell && editingCell.taskId === task.id && editingCell.stepId === step.id && editingCell.field === 'responsibility' ? (\r\n                      <div className=\"edit-cell-container\">\r\n                        <select\r\n                          value={editValue}\r\n                          onChange={(e) => setEditValue(e.target.value)}\r\n                          autoFocus\r\n                        >\r\n                          <option value=\"\">选择责任人</option>\r\n                          {dictConfig.responsiblePerson.map(person => (\r\n                            <option key={person} value={person}>{person}</option>\r\n                          ))}\r\n                        </select>\r\n                        <div className=\"edit-buttons\">\r\n                          <button className=\"save-edit-btn\" onClick={handleSaveEdit}>保存</button>\r\n                          <button className=\"cancel-edit-btn\" onClick={handleCancelEdit}>取消</button>\r\n                        </div>\r\n                      </div>\r\n                    ) : (\r\n                      step.responsibility\r\n                    )}\r\n                  </td>\r\n                  <td\r\n                    onDoubleClick={() => handleCellDoubleClick(task.id, step.id, 'taskstate', step.taskstate)}\r\n                  >\r\n                    {editingCell && editingCell.taskId === task.id && editingCell.stepId === step.id && editingCell.field === 'taskstate' ? (\r\n                      <div className=\"edit-cell-container\">\r\n                        <select\r\n                          value={editValue}\r\n                          onChange={(e) => setEditValue(e.target.value)}\r\n                          autoFocus\r\n                        >\r\n                          <option value=\"\">选择当前状态</option>\r\n                          {dictConfig.status.map(status => (\r\n                            <option key={status} value={status}>{status}</option>\r\n                          ))}\r\n                        </select>\r\n                        <div className=\"edit-buttons\">\r\n                          <button className=\"save-edit-btn\" onClick={handleSaveEdit}>保存</button>\r\n                          <button className=\"cancel-edit-btn\" onClick={handleCancelEdit}>取消</button>\r\n                        </div>\r\n                      </div>\r\n                    ) : (\r\n                      step.taskstate\r\n                    )}\r\n                  </td>\r\n                  <td\r\n                    // 修改双击事件处理函数的参数\r\n                      onDoubleClick={() => handleCellDoubleClick(task.id, step.id, 'iscomplete', step.iscomplete)}\r\n                    >\r\n                      {editingCell && editingCell.taskId === task.id && editingCell.stepId === step.id && editingCell.field === 'iscomplete' ? (\r\n                        <div className=\"edit-cell-container\">\r\n                          <select\r\n                            value={editValue}\r\n                            onChange={(e) => setEditValue(e.target.value)}\r\n                            autoFocus\r\n                          >\r\n                            <option value=\"是\">是</option>\r\n                            <option value=\"否\">否</option>\r\n                          </select>\r\n                          <div className=\"edit-buttons\">\r\n                            <button className=\"save-edit-btn\" onClick={handleSaveEdit}>保存</button>\r\n                            <button className=\"cancel-edit-btn\" onClick={handleCancelEdit}>取消</button>\r\n                          </div>\r\n                        </div>\r\n                      ) : (\r\n                        step.iscomplete  // 直接显示枚举值，不再使用三元表达式\r\n                      )}\r\n                    </td>\r\n                    \r\n                    \r\n                    <td\r\n                      onDoubleClick={() => handleCellDoubleClick(task.id, step.id, 'islate', step.islate)}\r\n                    >\r\n                      {editingCell && editingCell.taskId === task.id && editingCell.stepId === step.id && editingCell.field === 'islate' ? (\r\n                        <div className=\"edit-cell-container\">\r\n                          <select\r\n                            value={editValue}\r\n                            onChange={(e) => setEditValue(e.target.value)}\r\n                            autoFocus\r\n                          >\r\n                            <option value=\"是\">是</option>\r\n                            <option value=\"否\">否</option>\r\n                          </select>\r\n                          <div className=\"edit-buttons\">\r\n                            <button className=\"save-edit-btn\" onClick={handleSaveEdit}>保存</button>\r\n                            <button className=\"cancel-edit-btn\" onClick={handleCancelEdit}>取消</button>\r\n                          </div>\r\n                        </div>\r\n                      ) : (\r\n                        step.islate  // 直接显示枚举值，不再使用三元表达式\r\n                      )}\r\n                    </td>\r\n                  <td\r\n                    onDoubleClick={() => handleCellDoubleClick(task.id, step.id, 'priority', step.priority)}\r\n                  >\r\n                    {editingCell && editingCell.taskId === task.id && editingCell.stepId === step.id && editingCell.field === 'priority' ? (\r\n                      <div className=\"edit-cell-container\">\r\n                        <select\r\n                          value={editValue}\r\n                          onChange={(e) => setEditValue(e.target.value)}\r\n                          autoFocus\r\n                        >\r\n                          <option value=\"\">选择优先级</option>\r\n                          {dictConfig.priority.map(priority => (\r\n                            <option key={priority} value={priority}>{priority}</option>\r\n                          ))}\r\n                        </select>\r\n                        <div className=\"edit-buttons\">\r\n                          <button className=\"save-edit-btn\" onClick={handleSaveEdit}>保存</button>\r\n                          <button className=\"cancel-edit-btn\" onClick={handleCancelEdit}>取消</button>\r\n                        </div>\r\n                      </div>\r\n                    ) : (\r\n                      step.priority\r\n                    )}\r\n                  </td>\r\n                  <td\r\n                    onDoubleClick={() => handleCellDoubleClick(task.id, step.id, 'remark', step.remark)}\r\n                  >\r\n                    {editingCell && editingCell.taskId === task.id && editingCell.stepId === step.id && editingCell.field === 'remark' ? (\r\n                      <div className=\"edit-cell-container\">\r\n                        <input\r\n                          type=\"text\"\r\n                          value={editValue}\r\n                          onChange={(e) => setEditValue(e.target.value)}\r\n                          autoFocus\r\n                        />\r\n                        <div className=\"edit-buttons\">\r\n                          <button className=\"save-edit-btn\" onClick={handleSaveEdit}>保存</button>\r\n                          <button className=\"cancel-edit-btn\" onClick={handleCancelEdit}>取消</button>\r\n                        </div>\r\n                      </div>\r\n                    ) : (\r\n                      step.remark\r\n                    )}\r\n                  </td>\r\n                </tr>\r\n              ))}\r\n\r\n              {/* 步骤添加行 */}\r\n              <tr className=\"add-step-row\">\r\n                <td></td> {/* 任务名称列为空 */}\r\n                <td>\r\n                  <button \r\n                    className=\"add-step-btn\"\r\n                    onClick={() => handleAddStep(task.id)}\r\n                  >\r\n                    +\r\n                  </button>\r\n                </td>\r\n                {/* 其他列的空单元格 */}\r\n                {[...Array(8)].map((_, i) => (\r\n                  <td key={`step-empty-${i}`}></td>\r\n                ))}\r\n              </tr>\r\n\r\n              {/* 步骤编辑行\r\n              修改渲染部分，将输入框改为下拉菜单\r\n              找到新步骤行的渲染部分 */}\r\n\r\n              {showAddStepRow === task.id && (\r\n                <tr className=\"new-step-row\">\r\n                  <td rowSpan=\"1\"></td>\r\n                  <td>\r\n                    <input\r\n                      type=\"text\"\r\n                      value={newStepData.task_step}\r\n                      onChange={(e) => setNewStepData({...newStepData, task_step: e.target.value})}\r\n                      placeholder=\"输入任务步骤\"\r\n                      autoFocus\r\n                    />\r\n                    <div className=\"new-step-buttons\">\r\n                      <button className=\"save-step-btn\" onClick={() => handleSaveStep(task.id)}>保存</button>\r\n                      <button className=\"cancel-step-btn\" onClick={() => setShowAddStepRow(null)}>取消</button>\r\n                    </div>\r\n                  </td>\r\n                  <td>\r\n                    <input\r\n                      type=\"date\"\r\n                      value={newStepData.startdate}\r\n                      onChange={(e) => setNewStepData({...newStepData, startdate: e.target.value})}\r\n                    />\r\n                  </td>\r\n                  <td>\r\n                    <input\r\n                      type=\"date\"\r\n                      value={newStepData.enddate}\r\n                      onChange={(e) => setNewStepData({...newStepData, enddate: e.target.value})}\r\n                    />\r\n                  </td>\r\n                  <td>\r\n                    <select\r\n                      value={newStepData.responsibility}\r\n                      onChange={(e) => setNewStepData({...newStepData, responsibility: e.target.value})}\r\n                    >\r\n                      <option value=\"\">选择责任人</option>\r\n                      {dictConfig.responsiblePerson.map(person => (\r\n                        <option key={person} value={person}>{person}</option>\r\n                      ))}\r\n                    </select>\r\n                  </td>\r\n                  <td>\r\n                    <select\r\n                      value={newStepData.taskstate}\r\n                      onChange={(e) => setNewStepData({...newStepData, taskstate: e.target.value})}\r\n                    >\r\n                      <option value=\"\">选择当前状态</option>\r\n                      {dictConfig.status.map(status => (\r\n                        <option key={status} value={status}>{status}</option>\r\n                      ))}\r\n                    </select>\r\n                  </td>\r\n                  <td>\r\n                    <select\r\n                      value={newStepData.iscomplete}\r\n                      onChange={(e) => setNewStepData({...newStepData, iscomplete: e.target.value})}\r\n                    >\r\n                      <option value=\"\">选择</option>\r\n                      <option value=\"是\">是</option>\r\n                      <option value=\"否\">否</option>\r\n                    </select>\r\n                  </td>\r\n                  <td>\r\n                    <select\r\n                      value={newStepData.islate}\r\n                      onChange={(e) => setNewStepData({...newStepData, islate: e.target.value})}\r\n                    >\r\n                      <option value=\"\">选择</option>\r\n                      <option value=\"是\">是</option>\r\n                      <option value=\"否\">否</option>\r\n                    </select>\r\n                  </td>\r\n                  <td>\r\n                    <select\r\n                      value={newStepData.priority}\r\n                      onChange={(e) => setNewStepData({...newStepData, priority: e.target.value})}\r\n                    >\r\n                      <option value=\"\">选择优先级</option>\r\n                      {dictConfig.priority.map(priority => (\r\n                        <option key={priority} value={priority}>{priority}</option>\r\n                      ))}\r\n                    </select>\r\n                  </td>\r\n                  <td>\r\n                    <input\r\n                      type=\"text\"\r\n                      value={newStepData.remark}\r\n                      onChange={(e) => setNewStepData({...newStepData, remark: e.target.value})}\r\n                      placeholder=\"备注\"\r\n                    />\r\n                  </td>\r\n                </tr>\r\n              )}\r\n            </React.Fragment>\r\n          ))}\r\n\r\n          {/* 带添加按钮的持久行 */}\r\n          <tr className=\"add-task-row\">\r\n            <td>\r\n              <button \r\n                className=\"add-task-btn\"\r\n                onClick={() => setShowAddTaskRow(true)}\r\n              >\r\n                +\r\n              </button>\r\n            </td>\r\n            {/* 其他列的空单元格 */}\r\n            {[...Array(9)].map((_, i) => (\r\n              <td key={`add-empty-${i}`}></td>\r\n            ))}\r\n          </tr>\r\n        </tbody>\r\n      </table>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default TableComponent;\r\nconst handleAddStep = async (newStep) => {\r\n  // 从状态/上下文/Props中获取当前阶段ID\r\n  const { currentPhaseId } = this.state; // 或其他获取方式\r\n  await createStep(newStep, currentPhaseId);\r\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}